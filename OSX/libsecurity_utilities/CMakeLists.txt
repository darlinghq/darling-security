project(libsecurity_utilities)

mig(lib/mach_notify.defs)

target_include_directories(mach_notify_xtrace_mig PRIVATE
	${SECURITY_PROJECT_DIR}/OSX/libsecurity_cssm/lib
	${SECURITY_PROJECT_DIR}/OSX/include
	${SECURITY_PROJECT_DIR}/OSX/utilities/src
	${SECURITY_PROJECT_DIR}/OSX/libsecurity_apple_csp/open_ssl
	${SECURITY_PROJECT_DIR}/OSX/libsecurity_utilities/lib
)

add_macos_legacy_lib(security_utilities
	SOURCES
		lib/adornments.cpp
		lib/alloc.cpp
		lib/blob.cpp
		lib/ccaudit.cpp
		lib/cfclass.cpp
		lib/cfmach++.cpp
		lib/cfmunge.cpp
		lib/cfutilities.cpp
		lib/coderepository.cpp
		lib/crc.c
		lib/CSPDLTransaction.cpp
		lib/daemon.cpp
		lib/debugging_internal.cpp
		lib/dispatch.cpp
		lib/dyldcache.cpp
		lib/endian.cpp
		lib/errors.cpp
		lib/FileLockTransaction.cpp
		lib/globalizer.cpp
		lib/hashing.cpp
		lib/kq++.cpp
		lib/logging.cpp
		lib/mach++.cpp
		lib/macho++.cpp
		lib/machserver.cpp
		lib/muscle++.cpp
		lib/osxcode.cpp
		lib/pcsc++.cpp
		lib/powerwatch.cpp
		lib/seccfobject.cpp
		lib/simpleprefs.cpp
		lib/sqlite++.cpp
		lib/superblob.cpp
		lib/threading.cpp
		lib/timeflow.cpp
		lib/tqueue.cpp
		lib/trackingallocator.cpp
		lib/transactions.cpp
		lib/unix++.cpp
		lib/unixchild.cpp
		lib/utilities.cpp

		${CMAKE_CURRENT_BINARY_DIR}/lib/mach_notifyServer.c
	INCLUDES
		${SECURITY_PROJECT_DIR}/OSX/libsecurity_cssm/lib
		${SECURITY_PROJECT_DIR}/darling/include/iOS
		${SECURITY_PROJECT_DIR}/darling/include/macOS
		${SECURITY_PROJECT_DIR}/darling/include/Security
		${SECURITY_PROJECT_DIR}/OSX/include
		${SECURITY_PROJECT_DIR}
		${SECURITY_PROJECT_DIR}/OSX/libsecurity_apple_csp/open_ssl
		${SECURITY_PROJECT_DIR}/OSX/libsecurity_utilities/lib

		${CMAKE_CURRENT_BINARY_DIR}/lib
)

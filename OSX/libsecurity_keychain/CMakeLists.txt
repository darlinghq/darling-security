project(libsecurity_keychain)

add_compile_definitions(
	OS_LOG_FORMAT_WARNINGS=1
)

add_macos_legacy_lib(security_keychain
	SOURCES
		lib/Access.cpp
		lib/ACL.cpp
		lib/CCallbackMgr.cp
		lib/Certificate.cpp
		lib/CertificateValues.cpp
		lib/cssmdatetime.cpp
		lib/defaultcreds.cpp
		lib/DLDBListCFPref.cpp
		lib/DynamicDLDBList.cpp
		lib/ExtendedAttribute.cpp
		lib/Globals.cpp
		lib/Identity.cpp
		lib/IdentityCursor.cpp
		lib/Item.cpp
		lib/KCCursor.cpp
		lib/KCEventNotifier.cpp
		lib/KCUtilities.cpp
		lib/Keychains.cpp
		lib/KeyItem.cpp
		lib/Password.cpp
		lib/Policies.cpp
		lib/PolicyCursor.cpp
		lib/PrimaryKey.cpp
		lib/SecAccess.cpp
		lib/SecACL.cpp
		lib/SecBase.cpp
		lib/SecCertificate.cpp
		lib/SecCertificateBundle.cpp
		lib/SecCFTypes.cpp
		lib/SecExport.cpp
		lib/SecExternalRep.cpp
		lib/SecFDERecoveryAsymmetricCrypto.cpp
		lib/SecIdentity.cpp
		lib/SecIdentitySearch.cpp
		lib/SecImport.cpp
		lib/SecImportExport.c
		lib/SecImportExportAgg.cpp
		lib/SecImportExportCrypto.cpp
		lib/SecImportExportOpenSSH.cpp
		lib/SecImportExportPem.cpp
		lib/SecImportExportPkcs8.cpp
		lib/SecImportExportUtils.cpp
		lib/SecItem.cpp
		lib/SecItemConstants.c
		lib/SecKey.cpp
		lib/SecKeychain.cpp
		lib/SecKeychainAddIToolsPassword.cpp
		lib/SecKeychainItem.cpp
		lib/SecKeychainItemExtendedAttributes.cpp
		lib/SecKeychainSearch.cpp
		lib/SecNetscapeTemplates.cpp
		lib/SecPassword.cpp
		lib/SecPkcs8Templates.cpp
		lib/SecPolicy.cpp
		lib/SecPolicySearch.cpp
		lib/SecRandom.c
		lib/SecRecoveryPassword.c
		lib/SecTrust.cpp
		lib/SecTrustedApplication.cpp
		lib/SecTrustOSXEntryPoints.cpp
		lib/SecTrustSettings.cpp
		lib/SecWrappedKeys.cpp
		lib/StorageManager.cpp
		lib/TokenLogin.cpp
		lib/Trust.cpp
		lib/TrustAdditions.cpp
		lib/TrustedApplication.cpp
		lib/TrustItem.cpp
		lib/TrustRevocation.cpp
		lib/TrustSettings.cpp
		lib/TrustSettingsUtils.cpp
		lib/TrustStore.cpp
		lib/tsaDERUtilities.c
		lib/UnlockReferralItem.cpp
)

# don't know why it has a `.cp` extension, but it seems intentional
# there are comment inside the file that use this same extension when talking about the file
set_source_files_properties(lib/CCallbackMgr.cp PROPERTIES
	LANGUAGE CXX
	COMPILE_FLAGS "-x c++"
)
